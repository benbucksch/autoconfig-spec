<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Mail Autoconfig</title>
<meta content="Ben Bucksch" name="author">
<meta content="
       Set up a mail account with only email address and password. 
    " name="description">
<meta content="xml2rfc 3.28.0" name="generator">
<meta content="config" name="keyword">
<meta content="autoconfig" name="keyword">
<meta content="autodiscover" name="keyword">
<meta content="mail" name="keyword">
<meta content="email" name="keyword">
<meta content="IMAP" name="keyword">
<meta content="POP3" name="keyword">
<meta content="SMTP" name="keyword">
<meta content="JMAP" name="keyword">
<meta content="draft-ietf-mailmaint-autoconfig-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.0
    Python 3.12.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-mailmaint-autoconfig.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">autoconfig</td>
<td class="right">March 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Bucksch</td>
<td class="center">Expires 21 September 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">mailmaint</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-mailmaint-autoconfig-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-03-20" class="published">20 March 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-09-21">21 September 2025</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">B. Bucksch</div>
<div class="org">Beonex</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Mail Autoconfig</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Set up a mail account with only email address and password.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://benbucksch.github.io/autoconfig-spec/draft-ietf-mailmaint-autoconfig.html">https://benbucksch.github.io/autoconfig-spec/draft-ietf-mailmaint-autoconfig.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-mailmaint-autoconfig/">https://datatracker.ietf.org/doc/draft-ietf-mailmaint-autoconfig/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        mailmaint Working Group mailing list (<span><a href="mailto:mailmaint@ietf.org">mailto:mailmaint@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/mailmaint/">https://mailarchive.ietf.org/arch/browse/mailmaint/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/mailmaint/">https://www.ietf.org/mailman/listinfo/mailmaint/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/benbucksch/autoconfig-spec">https://github.com/benbucksch/autoconfig-spec</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 September 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-implementations" class="internal xref">Implementations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-data-format" class="internal xref">Data format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-xml-config-file" class="internal xref">XML config file</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-global-elements" class="internal xref">Global elements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-clientconfig" class="internal xref">clientConfig</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-emailprovider" class="internal xref">emailProvider</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="auto internal xref">3.2.3</a>.  <a href="#name-domain" class="internal xref">domain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="auto internal xref">3.2.4</a>.  <a href="#name-displayname-and-displayshor" class="internal xref">displayName and displayShortName</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-documentation" class="internal xref">documentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-server-sections" class="internal xref">Server sections</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-multiple-server-sections" class="internal xref">Multiple server sections</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-type" class="internal xref">type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-url-based-protocols" class="internal xref">URL-based protocols</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="auto internal xref">3.6.1</a>.  <a href="#name-url" class="internal xref">url</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="auto internal xref">3.6.2</a>.  <a href="#name-authentication" class="internal xref">authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.3">
                    <p id="section-toc.1-1.3.2.6.2.3.1"><a href="#section-3.6.3" class="auto internal xref">3.6.3</a>.  <a href="#name-username" class="internal xref">username</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-tcp-based-protocols" class="internal xref">TCP-based protocols</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1">
                    <p id="section-toc.1-1.3.2.7.2.1.1"><a href="#section-3.7.1" class="auto internal xref">3.7.1</a>.  <a href="#name-hostname" class="internal xref">hostname</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.2">
                    <p id="section-toc.1-1.3.2.7.2.2.1"><a href="#section-3.7.2" class="auto internal xref">3.7.2</a>.  <a href="#name-port" class="internal xref">port</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.3">
                    <p id="section-toc.1-1.3.2.7.2.3.1"><a href="#section-3.7.3" class="auto internal xref">3.7.3</a>.  <a href="#name-sockettype" class="internal xref">socketType</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.4">
                    <p id="section-toc.1-1.3.2.7.2.4.1"><a href="#section-3.7.4" class="auto internal xref">3.7.4</a>.  <a href="#name-authentication-2" class="internal xref">authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.5">
                    <p id="section-toc.1-1.3.2.7.2.5.1"><a href="#section-3.7.5" class="auto internal xref">3.7.5</a>.  <a href="#name-username-2" class="internal xref">username</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-placeholders" class="internal xref">Placeholders</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="auto internal xref">3.9</a>.  <a href="#name-xml-validation" class="internal xref">XML validation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-config-retrieval-by-mail-cl" class="internal xref">Config retrieval by mail clients</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-mail-provider" class="internal xref">Mail provider</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-customzing-the-config-for-a" class="internal xref">Customzing the config for a specific user</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-central-database" class="internal xref">Central database</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-mx" class="internal xref">MX</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-local-disk" class="internal xref">Local disk</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-other-mechanisms" class="internal xref">Other mechanisms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-manual-configuration" class="internal xref">Manual configuration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-config-validation" class="internal xref">Config validation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-user-approval" class="internal xref">User approval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-login-test" class="internal xref">Login test</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-oauth2-windows" class="internal xref">OAuth2 windows</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-config-publishing-by-mail-p" class="internal xref">Config publishing by mail providers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-config-location-for-single-" class="internal xref">Config location for single domain</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-config-location-for-domain-" class="internal xref">Config location for domain hosters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-return-config-for-non-exist" class="internal xref">Return config for non-existing email addresses</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-no-authentication-for-confi" class="internal xref">No authentication for config</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-oauth2-requirements" class="internal xref">OAuth2 requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-alternatives-considered" class="internal xref">Alternatives considered</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-dnssec" class="internal xref">DNSSEC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-dns-srv" class="internal xref">DNS SRV</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-capabilities" class="internal xref">CAPABILITIES</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-risk" class="internal xref">Risk</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-dns" class="internal xref">DNS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-http" class="internal xref">HTTP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-config-updates" class="internal xref">Config updates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-server-security" class="internal xref">Server security</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-registration" class="internal xref">Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-contents" class="internal xref">Contents</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-initial-registration" class="internal xref">Initial registration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This protocol allows users to set up their existing email account in a new
mail client application, by entering only their name, email address, and
password. The mail application, by means of mail autoconfig specified here,
will determine all the other parameters that are required, including IMAP or
POP3 hostname, TLS configuration, form of username, authentication method, and
other settings, and likewise for SMTP. Contact sync and calendar, file sharing
and other services can also be set up automatically.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The protocol works by first determining the domain from the email address, and
the querying well-known URLs at the email provider, which return the
configuration parameters in computer-readable form. Failing that, various
fallback sources can be applied, like a common database of configurations for
large email providers who do not directly support this protocol, or other
mechanisms to determine the configuration.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">While this AutoConfig protocol was conceived for configuring mail clients,
it can also be used for accounts of other types, like contacts and calendar
sync, chat, video conference, or online publishing. The primary concept and
limitation here is that these accounts need to be hosted by the same provider
as the email address.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementations">
<section id="section-2">
      <h2 id="name-implementations">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-implementations" class="section-name selfRef">Implementations</a>
      </h2>
<p id="section-2-1">This protocol is in production use since 15 years by major email clients, and
the config database (used as fallback) contains configurations for over 50% of
all email accounts.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Currently, this protocol or parts of it has been implemented by:<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">
          <p id="section-2-3.1.1"><a href="https://thunderbird.net">Thunderbird</a><a href="#section-2-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-3.2">
          <p id="section-2-3.2.1"><a href="https://parula.beonex.com">Parula</a><a href="#section-2-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-3.3">
          <p id="section-2-3.3.1"><a href="https://projects.gnome.org/evolution/">Evolution</a><a href="#section-2-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-3.4">
          <p id="section-2-3.4.1"><a href="https://userbase.kde.org/KMail">KMail</a><a href="#section-2-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-3.5">
          <p id="section-2-3.5.1"><a href="https://www.kontact.org">Kontact</a><a href="#section-2-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-3.6">
          <p id="section-2-3.6.1"><a href="https://k9mail.app">K9 Mail</a> and
<a href="https://www.thunderbird.net/mobile/">Thunderbird Mobile</a><a href="#section-2-3.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-3.7">
          <p id="section-2-3.7.1"><a href="https://email.faircode.eu">FairEmail</a><a href="#section-2-3.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-3.8">
          <p id="section-2-3.8.1"><a href="https://apps.nextcloud.com/apps/mail">NextCloud email</a><a href="#section-2-3.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-3.9">
          <p id="section-2-3.9.1"><a href="https://delta.chat/">Delta Chat</a><a href="#section-2-3.9.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-4">and likely other mail clients.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">The purpose of this paper is to document and specify what is deployed in the
wild.<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="data-format">
<section id="section-3">
      <h2 id="name-data-format">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-data-format" class="section-name selfRef">Data format</a>
      </h2>
<p id="section-3-1">Whether the ISP or a common central database returns the configuration, the
resulting document has the following data format.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The MIME type is <code>text/xml</code>.<a href="#section-3-2" class="pilcrow">¶</a></p>
<div id="xml-config-file">
<section id="section-3.1">
        <h3 id="name-xml-config-file">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-xml-config-file" class="section-name selfRef">XML config file</a>
        </h3>
<p id="section-3.1-1">The following example shows the syntax of the XML config file returned.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-2">
<pre>
&lt;?xml version="1.0"?&gt;
&lt;clientConfig version="1.2"&gt;
  &lt;emailProvider id="example.com"&gt;
    &lt;domain&gt;example.com&lt;/domain&gt;
    &lt;domain&gt;example.net&lt;/domain&gt;

    &lt;displayName&gt;Google Workspace&lt;/displayName&gt;
    &lt;displayShortName&gt;GMail&lt;/displayShortName&gt;

      &lt;!-- type=
      "imap": IMAP
      "pop3": POP3
      "jmap": JMAP
      "ews": Microsoft Exchange Web Services
      "activesync": Microsoft ActiveSync
      --&gt;
    &lt;incomingServer type="imap"&gt;
      &lt;hostname&gt;imap.example.com&lt;/hostname&gt;
      &lt;port&gt;993&lt;/port&gt;
        &lt;!--
        "plain": no encryption
        "SSL": TLS on TLS-specific port
        "STARTTLS": mandatory upgrade to TLS via STARTTLS
        --&gt;
      &lt;socketType&gt;SSL&lt;/socketType&gt;
        &lt;!-- Authentication methods:
        "password-cleartext": SASL PLAIN, LOGIN or protocol-native login.
        "password-encrypted": SASL CRAM-MD5, DIGEST-MD5 etc. Not TLS.
        "NTLM": Deprecated Windows login mechanism
        "GSSAPI": Kerberos or Windows GSSAPI
        "TLS-client-cert": TLS client certificate on TLS layer
        "OAuth2": Provider MUST adhere to section "OAuth2 requirements".
        "none": No authentication

        Multiple &lt;authentication&gt; elements per server
        config are valid. Clients will pick the first
        one that they support.
        --&gt;
      &lt;authentication&gt;password-cleartext&lt;/authentication&gt;
      &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
    &lt;/incomingServer&gt;

    &lt;!-- You can have multiple incoming servers,
      and even multiple IMAP server configs.
      The first config is the preferred one, but the user or
      or client can choose the alternative configs. --&gt;
    &lt;incomingServer type="pop3"&gt;
      &lt;hostname&gt;pop.example.com&lt;/hostname&gt;
      &lt;port&gt;995&lt;/port&gt;
      &lt;socketType&gt;SSL&lt;/socketType&gt;
      &lt;authentication&gt;password-cleartext&lt;/authentication&gt;
      &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
    &lt;/incomingServer&gt;

    &lt;!-- Needed only for IMAP or POP3 --&gt;
    &lt;outgoingServer type="smtp"&gt;
      &lt;hostname&gt;smtp.googlemail.com&lt;/hostname&gt;
      &lt;port&gt;587&lt;/port&gt;
      &lt;socketType&gt;STARTTLS&lt;/socketType&gt;
        &lt;!-- smtp-auth (RFC 2554, 4954) or other auth mechanism. --&gt;
      &lt;authentication&gt;password-cleartext&lt;/authentication&gt;
      &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
    &lt;/outgoingServer&gt;

    &lt;incomingServer type="jmap"&gt;
      &lt;url&gt;https://jmap.example.com&lt;/url&gt;
        &lt;!-- Authentication methods
        "http-basic": RRFC 7661
        "http-digest"
        "OAuth2": Provider MUST adhere to section "OAuth2 requirements".
        --&gt;
      &lt;authentication&gt;OAuth2&lt;/authentication&gt;
      &lt;authentication&gt;http-basic&lt;/authentication&gt;
      &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
    &lt;/incomingServer&gt;

    &lt;incomingServer type="ews"&gt;
      &lt;url&gt;https://mail.example.com/EWS/Exchange.asmx&lt;/url&gt;
      &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
      &lt;authentication&gt;http-basic&lt;/authentication&gt;
    &lt;/incomingServer&gt;

    &lt;incomingServer type="activesync"&gt;
      &lt;url&gt;https://mail.example.com/Microsoft-Server-ActiveSync&lt;/url&gt;
      &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
      &lt;authentication&gt;OAuth2&lt;/authentication&gt;
    &lt;/incomingServer&gt;

    &lt;documentation url="http://www.example.com/help/mail/"&gt;
      &lt;descr lang="en"&gt;Configure mail app for IMAP&lt;/descr&gt;
      &lt;descr lang="de"&gt;Email mit IMAP konfigurieren&lt;/descr&gt;
    &lt;/documentation&gt;

  &lt;/emailProvider&gt;

  &lt;addressbook type="carddav"&gt;
    &lt;url&gt;https://contacts.example.com/remote.php/dav&lt;/url&gt;
    &lt;authentication&gt;http-basic&lt;/authentication&gt;
    &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
  &lt;/addressbook&gt;

  &lt;calendar type="caldav"&gt;
    &lt;url&gt;https://calendar.example.com/remote.php/dav&lt;/url&gt;
    &lt;authentication&gt;http-basic&lt;/authentication&gt;
    &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
  &lt;/calendar&gt;

    &lt;!-- Upload files, allowing the user to share them.
    This can be used to send links instead of attachments,
    or to set up a file sync folder on the user's desktop.
    --&gt;
  &lt;fileShare type="webdav"&gt;
    &lt;url&gt;https://share.example.com/remote.php/dav&lt;/url&gt;
    &lt;authentication&gt;http-basic&lt;/authentication&gt;
    &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
  &lt;/fileShare&gt;

  &lt;chatServer type="xmpp"&gt;
    &lt;url&gt;wss://example.com:5281/xmpp-websocket&lt;/url&gt;
    &lt;authentication&gt;http-basic&lt;/authentication&gt;
    &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
  &lt;/chatServer&gt;

  &lt;chatServer type="xmpp"&gt;
    &lt;hostname&gt;xmpp.example.com&lt;/hostname&gt;
    &lt;port&gt;5223&lt;/port&gt;
    &lt;socketType&gt;TLS&lt;/socketType&gt;
    &lt;authentication&gt;password-cleartext&lt;/authentication&gt;
    &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
  &lt;/chatServer&gt;

  &lt;videoConference type="opentalk"&gt;
    &lt;url&gt;https://talk.example.com/login&lt;/url&gt;
    &lt;authentication&gt;OAuth2&lt;/authentication&gt;
    &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
  &lt;/videoConference&gt;

    &lt;!-- OAuth2 config for native public client apps.
    Gives e.g. clientID, expiry, and login page.
    The provider MUST adhere to "Open Client OAuth2 profile".
    --&gt;
  &lt;oAuth2&gt;
    &lt;authURL&gt;https://login.example.com/auth&lt;/authURL&gt;
    &lt;tokenURL&gt;https://login.example.com/token&lt;/tokenURL&gt;
    &lt;issuer&gt;login.example.com&lt;/issuer&gt;
    &lt;scope&gt;IMAP POP3 SMTP CalDAV CardDAV WebDAV offline_access&lt;/scope&gt;
    &lt;clientID&gt;open&lt;/clientID&gt;
    &lt;!-- optional --&gt;
    &lt;clientSecret&gt;give-me-your-password&lt;/clientSecret&gt;
  &lt;/oAuth2&gt;

  &lt;clientConfigUpdate url="https://www.example.com/config/mail.xml" /&gt;

&lt;/clientConfig&gt;
</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="global-elements">
<section id="section-3.2">
        <h3 id="name-global-elements">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-global-elements" class="section-name selfRef">Global elements</a>
        </h3>
<p id="section-3.2-1">The file starts with an XML header, e.g. <code>&lt;?xml version="1.0"?&gt;</code>,
and is encoded in UTF-8 without BOM.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div id="clientconfig">
<section id="section-3.2.1">
          <h4 id="name-clientconfig">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-clientconfig" class="section-name selfRef">clientConfig</a>
          </h4>
<p id="section-3.2.1-1">The root element of the XML file is <code>&lt;clientConfig version="1.2"&gt;</code>.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">The <code>version</code> is <code>1.2</code> for the version defined in this specification. <code>1.1</code> is
a compatible previous version. Higher versions are for future specifications.
The client <span class="bcp14">MUST NOT</span> reject a config file solely based on the version number.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="emailprovider">
<section id="section-3.2.2">
          <h4 id="name-emailprovider">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-emailprovider" class="section-name selfRef">emailProvider</a>
          </h4>
<p id="section-3.2.2-1">Element <code>&lt;emailProvider id="example.com"&gt;</code> is within the root element.
This element has no semantic purpose and exists for legacy reasons only.
If all of its child elements were within the root element, their meaning
would still be the same.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">The <code>id</code> is a unique string that typically matches the primary domain of the
provider.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">Within <code>&lt;emailProvider&gt;</code> are <code>&lt;domain&gt;</code>, <code>&lt;displayName&gt;</code> and
<code>&lt;displayShortName&gt;</code>, <code>&lt;documentation&gt;</code>, <code>&lt;incomingServer&gt;</code> and
<code>&lt;outgoingServer&gt;</code>.<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="domain">
<section id="section-3.2.3">
          <h4 id="name-domain">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-domain" class="section-name selfRef">domain</a>
          </h4>
<p id="section-3.2.3-1">E.g.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.3-2">
<pre>
&lt;domain&gt;example.com&lt;/domain&gt;
&lt;domain&gt;example.net&lt;/domain&gt;
&lt;domain purpose="mx"&gt;example-hosting.com&lt;/domain&gt;
</pre><a href="#section-3.2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.3-3">The content of the <code>&lt;domain&gt;</code> element defines which email addresses this config
is valid for. E.g. a config with <code>&lt;domain&gt;example.com&lt;/domain&gt;</code> is valid for
email address <code>fred@example.com</code>.<a href="#section-3.2.3-3" class="pilcrow">¶</a></p>
<p id="section-3.2.3-4">Multiple <code>&lt;domain&gt;</code> elements may be included, which means that the config is
valid for all of these domains. Their order has no meaning - you may sort them
by number of users, importance to the provider, or alphabethically.<a href="#section-3.2.3-4" class="pilcrow">¶</a></p>
<p id="section-3.2.3-5">A <code>&lt;domain purpose="mx"&gt;</code> specifies the domain name of the MX server of
the email address, and is used config file lookup using MX
server names, as specified in section MX. The <code>purpose</code> property is
mainly informational and may be ignored.<a href="#section-3.2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="displayname-and-displayshortname">
<section id="section-3.2.4">
          <h4 id="name-displayname-and-displayshor">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-displayname-and-displayshor" class="section-name selfRef">displayName and displayShortName</a>
          </h4>
<p id="section-3.2.4-1">E.g.<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.4-2">
<pre>
&lt;displayName&gt;Google Workspace&lt;/displayName&gt;
&lt;displayShortName&gt;GMail&lt;/displayShortName&gt;
</pre><a href="#section-3.2.4-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.4-3">The <code>&lt;displayName&gt;</code> element contains the name of the provider, e.g.
as preferred by the marketing of the provider itself. It <span class="bcp14">SHOULD</span> be no
longer than 30 characters, but <span class="bcp14">MUST</span> be no longer than 60 characters.<a href="#section-3.2.4-3" class="pilcrow">¶</a></p>
<p id="section-3.2.4-4">The <code>&lt;displayShortName&gt;</code> element contains the name of the provider, as
typically used by end users. It <span class="bcp14">SHOULD</span> be no longer than 12
characters, and it <span class="bcp14">MUST NOT</span> be longer than 20 characters.<a href="#section-3.2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="documentation">
<section id="section-3.3">
        <h3 id="name-documentation">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-documentation" class="section-name selfRef">documentation</a>
        </h3>
<p id="section-3.3-1">E.g.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-2">
<pre>
&lt;documentation url="http://www.example.com/help/mail/"&gt;
  &lt;descr lang="en"&gt;Configure mail app for IMAP&lt;/descr&gt;
  &lt;descr lang="de"&gt;Email mit IMAP konfigurieren&lt;/descr&gt;
&lt;/documentation&gt;
</pre><a href="#section-3.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.3-3">This is purely informational and not required for the automatic setup.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">Records the user help webpage at the provider that describes the mail
server settings. The config may be based on that page, but does not
necessarily have to match it, e.g. when a better config is available
than the one described on the webpage.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">The <code>url</code> property contains the URL of the webpage. The <code>&lt;descr&gt;</code>
content describes the content and purpose of the page and why it's
referenced here.
Multiple <code>&lt;descr&gt;</code> elements with different <code>lang</code> properties are
allowed, whereby the <code>lang</code> property contains the 2-letter ISO language
code, like the HTML <code>lang</code> attribute.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-sections">
<section id="section-3.4">
        <h3 id="name-server-sections">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-server-sections" class="section-name selfRef">Server sections</a>
        </h3>
<p id="section-3.4-1">E.g. <code>&lt;incomingServer type="jmap"&gt;</code> or <code>&lt;calendar type="carddav"&gt;</code><a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">
            <p id="section-3.4-2.1.1">The <code>type</code> property specifies the wire protocol that this server uses. See
section type below.<a href="#section-3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.2">
            <p id="section-3.4-2.2.1"><code>&lt;incomingServer&gt;</code> specifies the server that the mail client retrieves email
from and submits changes to. In many protocols, this server is also used for
sending email.<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.3">
            <p id="section-3.4-2.3.1"><code>&lt;outgoingServer&gt;</code> is used for sending, if <code>&lt;incomingServer&gt;</code> does not
support that directly.
This is currently used only for SMTP in combination with IMAP and POP3.<a href="#section-3.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.4">
            <p id="section-3.4-2.4.1"><code>&lt;incomingServer&gt;</code> and <code>&lt;outgoingServer&gt;</code> are within element
<code>&lt;emailProvider&gt;</code>, whereas <code>&lt;calendar&gt;</code>, <code>&lt;addressbook&gt;</code>, <code>&lt;fileShare&gt;</code>,
<code>&lt;chatServer&gt;</code> and <code>&lt;videoConference&gt;</code> are within the
root element <code>&lt;clientConfig&gt;</code>, i.e. one level higher.
Other than that, they work the same.<a href="#section-3.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.5">
            <p id="section-3.4-2.5.1">In some protocols, the <code>&lt;incomingServer&gt;</code> server additionally provides
calendars, addressbooks, and other data. For such protocols, the same server
is not repeated in other specific server sections like <code>&lt;calendar&gt;</code>.
Calendar-only clients supporting such multi-purpose protocols <span class="bcp14">MUST</span> read the
<code>&lt;incomingServer&gt;</code> (nonewithstanding that it's within legacy element
<code>&lt;emailProvider&gt;</code>)
and test and use the parts of the protocol needed for their
functionality.<a href="#section-3.4-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="multiple-server-sections">
<section id="section-3.4.1">
          <h4 id="name-multiple-server-sections">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-multiple-server-sections" class="section-name selfRef">Multiple server sections</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-3.4.1-1.1">
              <p id="section-3.4.1-1.1.1">Server sections of the same type (like <code>&lt;incomingServer&gt;</code> or <code>&lt;calendar&gt;</code>)
may appear multiple times in the same config file.
In this case, the one listed first is preferred by the config provider.
Unless the client has specific other requirements, it <span class="bcp14">SHOULD</span> pick the first
config.<a href="#section-3.4.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.4.1-1.2">
              <p id="section-3.4.1-1.2.1">The client may derivate from this recommendation, because<a href="#section-3.4.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.1-1.2.2.1">
                  <p id="section-3.4.1-1.2.2.1.1">the client doesn't support a higher-priority protocol, e.g. a JMAP
configuraion is listed first and is the most preferred, but the
client does not support JMAP yet, or<a href="#section-3.4.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.4.1-1.2.2.2">
                  <p id="section-3.4.1-1.2.2.2.1">the client doesn't support a configuration setting, e.g. it
doesn't support STARTTLS, or the config specifies only an OAuth2
authentication and the client either doesn't implement OAuth2, or
it doesn't have a client ID for this provider, or<a href="#section-3.4.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.4.1-1.2.2.3">
                  <p id="section-3.4.1-1.2.2.3.1">the client has a specific policy to prefer another configuration,
e.g. a STARTTLS config is listed before a direct TLS config, and
the client has a policy of preferring direct TLS, or likewise
the client prefers IMAP over POP3.<a href="#section-3.4.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-3.4.1-1.3">
              <p id="section-3.4.1-1.3.1">Server types, elements and protocols that the client does not support
<span class="bcp14">MUST</span> be ignored and the client <span class="bcp14">MUST</span> continue to parse the other
server sections, which may contain configs that the client
understands and supports. The client ignores the file only if there
is no supported and working config found.<a href="#section-3.4.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="type">
<section id="section-3.5">
        <h3 id="name-type">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-type" class="section-name selfRef">type</a>
        </h3>
<p id="section-3.5-1">The <code>type</code> property on the server section element specifies the
wire protocol that this server uses.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Element</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Base</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">incomingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>jmap</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">JMAP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 8620, RFC 8621, RFC 8887, RFC 9610 et al</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">incomingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>imap</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TCP</td>
              <td class="text-left" rowspan="1" colspan="1">IMAP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9051 or RFC 3501, et al</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">incomingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>pop3</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TCP</td>
              <td class="text-left" rowspan="1" colspan="1">POP3</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 1939, RFC 5034</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">outgoingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>smtp</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TCP</td>
              <td class="text-left" rowspan="1" colspan="1">SMTP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 5321, RFC 2822</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">calendar</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>caldav</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">CalDAV</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 4791</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">addressbook</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>carddav</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">CardDav</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 6352</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">fileShare</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>webdav</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">WebDAV</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 4918</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">chatServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>xmpp</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">XMPP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 6120, RFC 6121, RFC 7395</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">chatServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>xmpptcp</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TCP</td>
              <td class="text-left" rowspan="1" colspan="1">XMPP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 6120, RFC 6121</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">chatServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>matrix</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">Matrix</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://spec.matrix.org">https://spec.matrix.org</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">setupServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>managesieve</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TCP</td>
              <td class="text-left" rowspan="1" colspan="1">ManageSieve</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 5804, RFC 5228</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">incomingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>ews</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">Exchange Web Services</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">incomingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>activeSync</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">ActiveSync</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">incomingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>graph</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">Microsoft Graph</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
<p id="section-3.5-3">Other protocol names can be added using an IANA registry. Their
respective registrations need to define:
* Element: The XML element wrapping the server section.
* Type: The <code>type</code> property value of the server section.
* Base: Whether the protocol is URL-based or TCP-based,
* Name: The commonly used name of the protocol
* Specification: Which RFCs or document specifies the protocol, and
* Additional Elements: (Optional) Protocol-specific XML elements and
  their meaning.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="url-based-protocols">
<section id="section-3.6">
        <h3 id="name-url-based-protocols">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-url-based-protocols" class="section-name selfRef">URL-based protocols</a>
        </h3>
<p id="section-3.6-1">E.g.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.6-2">
<pre>
&lt;incomingServer type="jmap"&gt;
  &lt;url&gt;https://jmap.example.com/session&lt;/url&gt;
  &lt;authentication&gt;http-basic&lt;/authentication&gt;
  &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
&lt;/incomingServer&gt;
</pre><a href="#section-3.6-2" class="pilcrow">¶</a>
</div>
<p id="section-3.6-3">For server sections with protocols that are based on HTTPS or other
URLs, the following elements are supported:<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<div id="url">
<section id="section-3.6.1">
          <h4 id="name-url">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-url" class="section-name selfRef">url</a>
          </h4>
<p id="section-3.6.1-1">E.g. <code>&lt;url&gt;https://jmap.example.com/session&lt;/url&gt;</code><a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<p id="section-3.6.1-2">The content of the <code>&lt;url&gt;</code> element contains the URL where to contact the
server.<a href="#section-3.6.1-2" class="pilcrow">¶</a></p>
<p id="section-3.6.1-3">The URL scheme will normally be HTTPS and the URL start with <code>https://</code>.
Some protocols may use other schemes, e.g. WebSockets <code>wss://</code>.<a href="#section-3.6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication">
<section id="section-3.6.2">
          <h4 id="name-authentication">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-authentication" class="section-name selfRef">authentication</a>
          </h4>
<p id="section-3.6.2-1">E.g. <code>&lt;authentication&gt;http-basic&lt;/authentication&gt;</code><a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
<p id="section-3.6.2-2">The content of the <code>&lt;authentication&gt;</code> element defines which HTTP
authentication method to use.<a href="#section-3.6.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6.2-3.1">
              <p id="section-3.6.2-3.1.1"><code>http-basic</code>: Authenticate to the HTTP server using
<code>WWW-Authenticate: Basic</code>. See RFC 7617.<a href="#section-3.6.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.6.2-3.2">
              <p id="section-3.6.2-3.2.1"><code>http-digest</code>: Authenticate to the HTTP server using
<code>WWW-Authenticate: Digest</code>. See RFC 7616<a href="#section-3.6.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.6.2-3.3">
              <p id="section-3.6.2-3.3.1"><code>OAuth</code>: Authenticate to the HTTP server using
<code>WWW-Authenticate: Bearer</code>. See RFC 6750 Section 3.
The provider <span class="bcp14">MUST</span> adhere to the requirements defined in section OAuth2
in this specification.<a href="#section-3.6.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.6.2-4">The rules as specified in sections "Multiple authentication alternatives" and
"Authentication verification and fallback" apply here as well.<a href="#section-3.6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="username">
<section id="section-3.6.3">
          <h4 id="name-username">
<a href="#section-3.6.3" class="section-number selfRef">3.6.3. </a><a href="#name-username" class="section-name selfRef">username</a>
          </h4>
<p id="section-3.6.3-1">E.g. <code>&lt;username&gt;%EMAILADDRESS%&lt;/username&gt;</code> or <code>&lt;username&gt;fred&lt;/username&gt;</code><a href="#section-3.6.3-1" class="pilcrow">¶</a></p>
<p id="section-3.6.3-2">The username to use for the authentication method.<a href="#section-3.6.3-2" class="pilcrow">¶</a></p>
<p id="section-3.6.3-3">Placeholders <span class="bcp14">MUST</span> be replaced before using the actual value. See section
"Placeholders".<a href="#section-3.6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="tcp-based-protocols">
<section id="section-3.7">
        <h3 id="name-tcp-based-protocols">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-tcp-based-protocols" class="section-name selfRef">TCP-based protocols</a>
        </h3>
<p id="section-3.7-1">For server sections with protocols that are based on TCP,
the following elements are supported:<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7-2">
<pre>
&lt;incomingServer type="imap"&gt;
  &lt;hostname&gt;imap.example.com&lt;/hostname&gt;
  &lt;port&gt;993&lt;/port&gt;
  &lt;socketType&gt;SSL&lt;/socketType&gt;
  &lt;authentication&gt;password-cleartext&lt;/authentication&gt;
  &lt;username&gt;%EMAILADDRESS%&lt;/username&gt;
&lt;/incomingServer&gt;
</pre><a href="#section-3.7-2" class="pilcrow">¶</a>
</div>
<div id="hostname">
<section id="section-3.7.1">
          <h4 id="name-hostname">
<a href="#section-3.7.1" class="section-number selfRef">3.7.1. </a><a href="#name-hostname" class="section-name selfRef">hostname</a>
          </h4>
<p id="section-3.7.1-1">E.g. <code>&lt;hostname&gt;imap.example.com&lt;/hostname&gt;</code><a href="#section-3.7.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.1-2">The content of the <code>&lt;hostname&gt;</code> element contains the fully qualified hostname
of the server.<a href="#section-3.7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="port">
<section id="section-3.7.2">
          <h4 id="name-port">
<a href="#section-3.7.2" class="section-number selfRef">3.7.2. </a><a href="#name-port" class="section-name selfRef">port</a>
          </h4>
<p id="section-3.7.2-1">E.g. <code>&lt;port&gt;993&lt;/port&gt;</code><a href="#section-3.7.2-1" class="pilcrow">¶</a></p>
<p id="section-3.7.2-2">The content of the <code>&lt;port&gt;</code> element is an integer and contains the TCP port
number at the hostname. The port is typically specific to the combination of
the wire protocol and socketType.<a href="#section-3.7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sockettype">
<section id="section-3.7.3">
          <h4 id="name-sockettype">
<a href="#section-3.7.3" class="section-number selfRef">3.7.3. </a><a href="#name-sockettype" class="section-name selfRef">socketType</a>
          </h4>
<p id="section-3.7.3-1">E.g. <code>&lt;socketType&gt;SSL&lt;/socketType&gt;</code><a href="#section-3.7.3-1" class="pilcrow">¶</a></p>
<p id="section-3.7.3-2">The content of the <code>&lt;socketType&gt;</code> element specifies whether to use direct TLS,
STARTTLS, or none of these.<a href="#section-3.7.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7.3-3.1">
              <p id="section-3.7.3-3.1.1"><code>SSL</code>: Directly contact the TCP port using TLS. TLS version 1.2 or higher
<span class="bcp14">SHOULD</span> be used. Higher versions may be required based on security situation,
server support, and client policy decisions.<a href="#section-3.7.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.7.3-3.2">
              <p id="section-3.7.3-3.2.1"><code>STARTTLS</code>: Contact the TCP port first using an unencrypted plain socket,
then upgrade to TLS
using the protocol-specific STARTTLS specification. With this configuration,
STARTTLS <span class="bcp14">MUST</span> be used and TLS <span class="bcp14">MUST</span> be used after the STARTTLS upgrade. If
the upgrade to TLS fails for whatever reason, the client <span class="bcp14">MUST</span>
disconnect and <span class="bcp14">MUST NOT</span> try to authenticate. This prevents downgrade attacks
that could otherwise steal passwords, user data, and impersonate users.<a href="#section-3.7.3-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.7.3-3.3">
              <p id="section-3.7.3-3.3.1"><code>plain</code>: Unencrypted connection, with neither TLS nor STARTTLS. May be
needed for local servers. Deprecated.<a href="#section-3.7.3-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="tls-validation">
<section id="section-3.7.3.1">
            <h5 id="name-tls-validation">
<a href="#section-3.7.3.1" class="section-number selfRef">3.7.3.1. </a><a href="#name-tls-validation" class="section-name selfRef">TLS validation</a>
            </h5>
<p id="section-3.7.3.1-1">In all cases where TLS is used, either directly or using STARTTLS,
the client <span class="bcp14">MUST</span> validate the TLS certificate and ensure that the
certificate is valid for the hostname given in this config. If not,
or if the TLS certificate is otherwise invalid, the client <span class="bcp14">MUST</span>
either disconnect or <span class="bcp14">MAY</span> warn the user of the
dangers and ask for user confirmation. Such warning and confirmation
<span class="bcp14">MAY</span> only be allowed at original configuration and <span class="bcp14">MUST NOT</span> be allowed
during normal everyday connection.<a href="#section-3.7.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.3.1-2">If the server had a valid TLS certificate during original configuration
and the TLS certificate is invalid during normal connection, the
client <span class="bcp14">MUST</span> disconnect.<a href="#section-3.7.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.7.3.1-3">If the problem is that the TLS certificate expired recently,
the client <span class="bcp14">MAY</span> not consider that a failure during normal connection
and use other recovery mechanisms.<a href="#section-3.7.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authentication-1">
<section id="section-3.7.4">
          <h4 id="name-authentication-2">
<a href="#section-3.7.4" class="section-number selfRef">3.7.4. </a><a href="#name-authentication-2" class="section-name selfRef">authentication</a>
          </h4>
<p id="section-3.7.4-1">E.g. <code>&lt;authentication&gt;password-cleartext&lt;/authentication&gt;</code><a href="#section-3.7.4-1" class="pilcrow">¶</a></p>
<p id="section-3.7.4-2">The content of the <code>&lt;authentication&gt;</code> element defines which authentication
method to use. This can be either an authentication defined by the wire
protocol, or a SASL scheme, or a successor to SASL.<a href="#section-3.7.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7.4-3.1">
              <p id="section-3.7.4-3.1.1"><code>password-cleartext</code>: Send password in the clear.
Uses either the native authentication method defined by the wire protocol
(if that is based on plaintext passwords), or a SASL authentication scheme
like SASL <code>PLAIN</code> or SASL <code>LOGIN</code>, or a successor.<a href="#section-3.7.4-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.7.4-3.2">
              <p id="section-3.7.4-3.2.1"><code>password-encrypted</code>: An encrypted or hashed password mechanism.
Includes SASL <code>CRAM-MD5</code>, <code>DIGEST-MD5</code> and <code>SCRAM-SHA-256-PLUS</code>.
TLS alone by itself does not qualify as "password-encrypted".<a href="#section-3.7.4-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.7.4-3.3">
              <p id="section-3.7.4-3.3.1"><code>NTLM</code>: Legacy Windows login mechanisms NTLM or NTLMv2.<a href="#section-3.7.4-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.7.4-3.4">
              <p id="section-3.7.4-3.4.1"><code>GSSAPI</code>: Kerberos or GSSAPI, a single-signon mechanism based on TCP.<a href="#section-3.7.4-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.7.4-3.5">
              <p id="section-3.7.4-3.5.1"><code>TLS-client-cert</code>: On the SSL/TLS layer, after server request, the client
sends a TLS client certificate for the user, possibly after letting the user
select confirm it. Uses SASL <code>EXTERNAL</code> scheme.<a href="#section-3.7.4-3.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.7.4-3.6">
              <p id="section-3.7.4-3.6.1"><code>OAuth</code>: OAuth. SASL <code>OAUTHBEARER</code> (current) or <code>XOAUTH2</code> (deprecated) or
successors. The provider <span class="bcp14">MUST</span> adhere to the requirements defined in
section OAuth2 in this specification.<a href="#section-3.7.4-3.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.7.4-3.7">
              <p id="section-3.7.4-3.7.1"><code>client-IP-address</code>: Server can be used without any explicit authentication,
and the client is admitted based on its IP address.
This may be the case for some SMTP servers on local networks.
Not supported on the Internet. Deprecated, because it breaks mobile devices.<a href="#section-3.7.4-3.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="recommending-specific-sasl-schemes">
<section id="section-3.7.4.1">
            <h5 id="name-recommending-specific-sasl-">
<a href="#section-3.7.4.1" class="section-number selfRef">3.7.4.1. </a><a href="#name-recommending-specific-sasl-" class="section-name selfRef">Recommending specific SASL schemes</a>
            </h5>
<p id="section-3.7.4.1-1">Additionally, a specific SASL scheme may be specified using <code>SASL</code>, a space,
and the specific SASL authentication scheme name, e.g.
<code>SASL SCRAM-SHA-256-PLUS</code>. In such a case, the server config <span class="bcp14">SHOULD</span> also
specify a more generic authentication mechanism as a lower priority
alternative. That would make clients use the specific authentication
mechanism, if they support it, and other clients will use the more generic
authentication mechanism.<a href="#section-3.7.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-authentication-alternatives">
<section id="section-3.7.4.2">
            <h5 id="name-multiple-authentication-alt">
<a href="#section-3.7.4.2" class="section-number selfRef">3.7.4.2. </a><a href="#name-multiple-authentication-alt" class="section-name selfRef">Multiple authentication alternatives</a>
            </h5>
<p id="section-3.7.4.2-1">The <code>&lt;authentication&gt;</code> element may appear multiple times within a server
section. In this case, they are ordered from the most to the least preferred
method, based on the policy of the provider.<a href="#section-3.7.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.7.4.2-2">If a client does not support a
specific authentication scheme, or does not have the conditions to use it,
e.g. the client does not have a Client ID for this OAuth2 server, then the
client <span class="bcp14">MUST</span> skip this <code>&lt;authentication&gt;</code> element and use the next in the list
instead.<a href="#section-3.7.4.2-2" class="pilcrow">¶</a></p>
<p id="section-3.7.4.2-3">If none of the authentication methods are supported by the client,
the client <span class="bcp14">MUST</span> ignore that server section and use the remaining server
sections.<a href="#section-3.7.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-verification-and-fallback">
<section id="section-3.7.4.3">
            <h5 id="name-authentication-verification">
<a href="#section-3.7.4.3" class="section-number selfRef">3.7.4.3. </a><a href="#name-authentication-verification" class="section-name selfRef">Authentication verification and fallback</a>
            </h5>
<p id="section-3.7.4.3-1">The client <span class="bcp14">SHOULD</span> test the configuration during setup, with an actual
authentication attempt.<a href="#section-3.7.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.7.4.3-2">If the authentication fails, the client decides based on the
authentication error code how to proceed. E.g. if the authentiocation
method itself failed, or the error code indicates a systemic failure,
the client <span class="bcp14">SHOULD</span> use a lower-priority authentication method from the
list.<a href="#section-3.7.4.3-2" class="pilcrow">¶</a></p>
<p id="section-3.7.4.3-3">If the authentication method is working, but the error code indicated
that the username or password was wrong, then the client <span class="bcp14">MAY</span> ask the
user to correct the password.<a href="#section-3.7.4.3-3" class="pilcrow">¶</a></p>
<p id="section-3.7.4.3-4">For that reason, the server <span class="bcp14">SHOULD</span> be specific in the error codes and
allow the client to distinguish between
* an unsupported or non-working authentication method or other
  systemic failures
* the client being rejected by the server
* the user being blocked from login
* the user authentication failing due to wrong password or username
* other reasons<a href="#section-3.7.4.3-4" class="pilcrow">¶</a></p>
<p id="section-3.7.4.3-5">If the server were to return the same error code for all these cases, the
client might tell the user that the password is wrong, and the user starts
attempting other passwords, potentially revealing passwords to other
higher-value assets, which is highly dangerous.<a href="#section-3.7.4.3-5" class="pilcrow">¶</a></p>
<p id="section-3.7.4.3-6">If the authentification succeeded, the client <span class="bcp14">SHOULD</span> take note of the
working configutation and use that for all subsequent connections,
until an explicit reconfiguration occurs. During normal everyday operation,
the client <span class="bcp14">SHOULD NOT</span> fallback nor attempt multiple different authentication
methods.<a href="#section-3.7.4.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="username-1">
<section id="section-3.7.5">
          <h4 id="name-username-2">
<a href="#section-3.7.5" class="section-number selfRef">3.7.5. </a><a href="#name-username-2" class="section-name selfRef">username</a>
          </h4>
<p id="section-3.7.5-1">E.g. <code>&lt;username&gt;%EMAILADDRESS%&lt;/username&gt;</code> or <code>&lt;username&gt;fred&lt;/username&gt;</code><a href="#section-3.7.5-1" class="pilcrow">¶</a></p>
<p id="section-3.7.5-2">The username to use for the authentication method.<a href="#section-3.7.5-2" class="pilcrow">¶</a></p>
<p id="section-3.7.5-3">Placeholders <span class="bcp14">MUST</span> be replaced before using the actual value. See section
"Placeholders".<a href="#section-3.7.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="placeholders">
<section id="section-3.8">
        <h3 id="name-placeholders">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-placeholders" class="section-name selfRef">Placeholders</a>
        </h3>
<p id="section-3.8-1">The <code>&lt;username&gt;</code> value may contain placeholders.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<p id="section-3.8-2">The following special substrings in the value <span class="bcp14">MUST</span> be
replaced by the client, before the value is actually used.<a href="#section-3.8-2" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Placeholder</th>
              <th class="text-left" rowspan="1" colspan="1">Replace with</th>
              <th class="text-left" rowspan="1" colspan="1">Example</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>%EMAILADDRESS%</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">E-Mail-Address of the user</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>fred@example.com</code>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>%EMAILLOCALPART%</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Part before <code>@</code> in the E-Mail-Address</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>fred</code>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>%EMAILDOMAIN%</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Part after <code>@</code> in the E-Mail-Address</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>example.com</code>
</td>
            </tr>
          </tbody>
        </table>
<p id="section-3.8-4">Some clients <span class="bcp14">MAY</span> also support the same placeholders for the fields
<code>&lt;hostname&gt;</code>, <code>&lt;url&gt;</code>, <code>&lt;authURL&gt;</code>, <code>&lt;tokenURL&gt;</code>, <code>&lt;issuer&gt;</code>,
<code>&lt;displayName&gt;</code> and <code>&lt;displayShortName&gt;</code>.<a href="#section-3.8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="xml-validation">
<section id="section-3.9">
        <h3 id="name-xml-validation">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-xml-validation" class="section-name selfRef">XML validation</a>
        </h3>
<p id="section-3.9-1">The client <span class="bcp14">SHOULD</span> validate that the config file is valid XML, and if
the XML syntax is invalid, the client <span class="bcp14">SHOULD</span> ignore the entire file. In
contrast, if there are syntactically valid, but unknown elements or
properties, the client <span class="bcp14">MUST NOT</span> ignore the file.<a href="#section-3.9-1" class="pilcrow">¶</a></p>
<p id="section-3.9-2">The client <span class="bcp14">SHOULD</span> take only the elements and attributes that are
supported by the client, and <span class="bcp14">MUST</span> ignore the others that are unknown
to the client.<a href="#section-3.9-2" class="pilcrow">¶</a></p>
<p id="section-3.9-3">The client may optionally want to validate the XML before parsing it.
This is not required. If the client choses to validate, the validation
<span class="bcp14">MUST</span> ignore unknown elements and properties and <span class="bcp14">MUST NOT</span>
drop or ignore a configuration that contains unknown elements and
properties. This is needed to allow future extensions of the format
without breaking existing clients.<a href="#section-3.9-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="config-retrieval-by-mail-clients">
<section id="section-4">
      <h2 id="name-config-retrieval-by-mail-cl">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-config-retrieval-by-mail-cl" class="section-name selfRef">Config retrieval by mail clients</a>
      </h2>
<p id="section-4-1">The mail client application, when it needs the configuration for a given email
address, will perform several steps to retrieve the configuration from various
sources.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The steps are ordered by priority. They may all be requested at the same time,
but a higher priorty result that is available <span class="bcp14">SHOULD</span> be preferred over a lower
priority one, even if the lower priority one is available earlier. Exceptions
apply when a higher priority result is either invalid or outdated, or the
fetch method is less secure. Lower priority requests <span class="bcp14">MAY</span> be cancelled, if a
valid higher priority result has been successfully received. The priority is
expressed below with the number before the URL or location, with lower numbers
meaning higher priority, e.g. 1.2 has higher priority than 4.1.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">In the URLs below, <code>%EMAILADDRESS%</code> shall be replaced with the email address
that the user entered and wishes to use, and <code>%EMAILDOMAIN%</code> shall be replaced
with the email domain extracted from the email address. For example, for
"fred@example.com", the email domain is "example.com", and for
"fred@test.cs.example.net", the email domain is "test.cs.example.net".<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">For full support of this specification, all "Required" and "Recommended"
mechanisms <span class="bcp14">MUST</span> be implemented and working. For partial support of this
specification, all "Required" mechanisms <span class="bcp14">MUST</span> be implemented and working, and
in this case, you shall make explicit when advertizing or referring to auto
config that there is only partial support of this specification.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="mail-provider">
<section id="section-4.1">
        <h3 id="name-mail-provider">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-mail-provider" class="section-name selfRef">Mail provider</a>
        </h3>
<p id="section-4.1-1">First step is to directly ask the mail provider and allow it to return the
configuration. This step ensures that the protocol is decentralized and the
mail provider is in control of the configuration issued to mail clients.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">1.1. <code>https://autoconfig.%EMAILDOMAIN%/mail/config-v1.1.xml?emailaddress=%EMAILADDRESS%</code> (Required. <code>emailaddress</code> is Optional)<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">1.2. <code>https://%EMAILDOMAIN%/.well-known/autoconfig/mail/config-v1.1.xml</code> (Optional)<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">1.3. <code>http://autoconfig.%EMAILDOMAIN%/mail/config-v1.1.xml</code> (Optional)<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-3">For example:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">
            <p id="section-4.1-4.1.1">1.1. https://autoconfig.example.com/mail/config-v1.1.xml?emailaddress=fred@example.com<a href="#section-4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.2">
            <p id="section-4.1-4.2.1">1.2. https://example.com/.well-known/autoconfig/mail/config-v1.1.xml<a href="#section-4.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.3">
            <p id="section-4.1-4.3.1">1.3. http://autoconfig.example.com/mail/config-v1.1.xml<a href="#section-4.1-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-5">Step 1.3. is mainly for legacy servers. Many current deployments
use this HTTP URL.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<div id="customzing-the-config-for-a-specific-user">
<section id="section-4.1.1">
          <h4 id="name-customzing-the-config-for-a">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-customzing-the-config-for-a" class="section-name selfRef">Customzing the config for a specific user</a>
          </h4>
<p id="section-4.1.1-1">To allow the mail provider to return a configuration adjusted for that mailbox,
the client sends the email address as query parameter in URL 1.1. This allows
the mail provider to e.g. separate mailboxes on geographically local mail
servers, e.g. a mail server located in the same office building where an
employee works.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">However, while the protocol allows for such heterogenous configurations, mail
providers are discouraged from doing so, and are instead encouraged to provide
one single configuration for all their users. For example, DNS resolution
based on location, mail proxy servers, or other techniques as necessary, can
be used to route the traffic and host the mail efficiently.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3">This mechanism also allows the autoconfig server to map the email address to
a username that cannot be expressed using the Placeholders (see section).
However, this method is discouraged. Instead, the email server login should
accept email addresses as username, and doing the mapping to internal
usernames at login time, which avoids the need for the client to know a
different username.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">To avoid that email addresses can be tested for validity, whenever customized
configs are returned, the autoconfig server should respond to non-existing
email addresses with a configuation that appears to be real and is similar in
structure to real configurations, e.g. a random host out of the pool of actual
hosts.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="central-database">
<section id="section-4.2">
        <h3 id="name-central-database">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-central-database" class="section-name selfRef">Central database</a>
        </h3>
<p id="section-4.2-1">The ISPDB contains the configurations for most mail providers with a market
share larger than 0.1%, and contains configurations for half of the email
accounts in the world.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">This is a useful fallback for mail providers which do not host a config server
described in the previous step. Using a central database (ISPDB) of mail
configurations for the large mail providers will increase the success rate of
finding a valid configuration drastically, up to 10-fold.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">The mail client application may choose the mail config database provider. A
public mail config database is available at base URL <code>https://v1.ispdb.net/</code>.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4"><code>%ISPDB%</code> below is the base URL of that database.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-5.1">
            <p id="section-4.2-5.1.1">2.1. <code>%ISPDB%%EMAILDOMAIN%</code> (Recommended)<a href="#section-4.2-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-6">For example:<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-7.1">
            <p id="section-4.2-7.1.1">2.1. <a href="https://v1.ispdb.net/geologist.com">https://v1.ispdb.net/geologist.com</a><a href="#section-4.2-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="mx">
<section id="section-4.3">
        <h3 id="name-mx">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-mx" class="section-name selfRef">MX</a>
        </h3>
<p id="section-4.3-1">Many companies do not maintain their own mail server, but let their email be
hosted by a hosting company, which is then responsible for the email of dozens
or thousands of domains. For these hosters, it may be difficult to set up the
configuration server (step 1.1.) with valid TLS certificate for each of their
customers, and to convince their customers to modify their root DNS
specifically for autoconfig. On the other side, the ISPDB can only contain the
hosting company and cannot know all their customers. To handle such domains,
the protocol first needs to find the server hosting the email.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">If the previous mechanisms yield no result, the client <span class="bcp14">SHOULD</span> perform a DNS MX
lookup on the email domain, and retrieve the MX server (incoming SMTP server)
for that domain. Only the highest priority MX hostname is considered. From
that MX hostname, 2 values are extracted:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-3.1">
            <p id="section-4.3-3.1.1">Extract only the second-level domain from the MX hostname, and use that as
value for <code>%MXBASEDOMAIN%</code>. To determine the second-level domain, use the
<a href="https://publicsuffix.org">Public Suffic List</a> or a similarly suited method,
to correctly handle domains like ".co.uk" and ".com.au".<a href="#section-4.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-3.2">
            <p id="section-4.3-3.2.1">Remove the first component from the MX hostname, i.e. everything up to and
including the first <code>.</code>, and use that as value for <code>%MXFULLDOMAIN%</code>. Use it
only if it is longer than <code>%MXBASEDOMAIN%</code>.<a href="#section-4.3-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-4">For example:<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-5.1">
            <p id="section-4.3-5.1.1">For "mx.example.com", the MXFULLDOMAIN and MXBASEDOMAIN are both
"example.com".<a href="#section-4.3-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-5.2">
            <p id="section-4.3-5.2.1">For "mx.example.co.uk", the MXFULLDOMAIN and MXBASEDOMAIN are both
"example.co.uk".<a href="#section-4.3-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-5.3">
            <p id="section-4.3-5.3.1">For "mx.premium.europe.example.com", the MXFULLDOMAIN is
"premium.europe.example.com" and the MXBASEDOMAIN is "example.com".<a href="#section-4.3-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-6">Then, attempt to retrieve the config for these MX domains, using the previous
methods:<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-7.1">
            <p id="section-4.3-7.1.1">3.1. <code>https://autoconfig.%MXFULLDOMAIN%/.well-known/mail-v1.xml?emailaddress=%EMAILADDRESS%</code> (Required)<a href="#section-4.3-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-7.2">
            <p id="section-4.3-7.2.1">3.2. <code>https://autoconfig.%MXBASEDOMAIN%/.well-known/mail-v1.xml?emailaddress=%EMAILADDRESS%</code> (Recommended)<a href="#section-4.3-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-7.3">
            <p id="section-4.3-7.3.1">3.3. <code>%ISPDB%%MXFULLDOMAIN%</code> (Recommended)<a href="#section-4.3-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-7.4">
            <p id="section-4.3-7.4.1">3.4. <code>%ISPDB%%MXBASEDOMAIN%</code> (Recommended)<a href="#section-4.3-7.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-8">For example:<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-9.1">
            <p id="section-4.3-9.1.1">3.1. https://autoconfig.premium.europe.example.com/.well-known/mail-v1.xml?emailaddress=fred@example.com<a href="#section-4.3-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-9.2">
            <p id="section-4.3-9.2.1">3.2. https://autoconfig.example.com/.well-known/mail-v1.xml?emailaddress=fred@example.com<a href="#section-4.3-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-9.3">
            <p id="section-4.3-9.3.1">3.3. https://v1.ispdb.net/premium.europe.example.com<a href="#section-4.3-9.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-9.4">
            <p id="section-4.3-9.4.1">3.4. https://v1.ispdb.net/example.com<a href="#section-4.3-9.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="local-disk">
<section id="section-4.4">
        <h3 id="name-local-disk">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-local-disk" class="section-name selfRef">Local disk</a>
        </h3>
<p id="section-4.4-1">For testing purposes, you may want to define a location on the disk, relative
to the application installation directory, or relative to the user
configuration directory, which may contain a configuration file for a specific
domain, and which your application will use, if the above methods fail.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">
            <p id="section-4.4-2.1.1">4.1. <code>%USER_CONFIGURATION_DIR%/isp/%EMAILDOMAIN%.xml</code> (Optional)<a href="#section-4.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.2">
            <p id="section-4.4-2.2.1">4.2. <code>%APP_INSTALL_DIR%/isp/%EMAILDOMAIN%.xml</code> (Optional)<a href="#section-4.4-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.4-3">For example:<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-4.1">
            <p id="section-4.4-4.1.1">4.1. /home/fred/.config/yourapp/isp/example.com.xml<a href="#section-4.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-4.2">
            <p id="section-4.4-4.2.1">4.2. /opt/yourapp/isp/example.com.xml<a href="#section-4.4-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="other-mechanisms">
<section id="section-4.5">
        <h3 id="name-other-mechanisms">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-other-mechanisms" class="section-name selfRef">Other mechanisms</a>
        </h3>
<p id="section-4.5-1">You may want to implement other mechanisms to find a configuration, for
example Exchange AutoDiscover, DNS SRV, or heuristic guessing. If you
implement such alternative methods, and if they are less secure than some of
the mechanisms provided here, the alternative methods <span class="bcp14">SHOULD</span> be considered
only with lower priority (as defined above) than the more secure mechanisms
defined here. For evaluating other mechanisms, use similar criteria as
outlined in section "Security considerations".<a href="#section-4.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="manual-configuration">
<section id="section-4.6">
        <h3 id="name-manual-configuration">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-manual-configuration" class="section-name selfRef">Manual configuration</a>
        </h3>
<p id="section-4.6-1">If the above mechanisms fail to provide a working configuration, or if the
user explicitly chooses so, you <span class="bcp14">SHOULD</span> give the end user the ability to
manually enter a configuration, and use that configuration to configure the
account.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="config-validation">
<section id="section-5">
      <h2 id="name-config-validation">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-config-validation" class="section-name selfRef">Config validation</a>
      </h2>
<div id="user-approval">
<section id="section-5.1">
        <h3 id="name-user-approval">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-user-approval" class="section-name selfRef">User approval</a>
        </h3>
<p id="section-5.1-1">Independent of the mechanisms used to find the configuration, before using
that configuration, you <span class="bcp14">SHOULD</span> display that configuration to the end user and
let him confirm it. While doing so:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">
            <p id="section-5.1-2.1.1">At least the second-level domain name(s) of the hostnames involved <span class="bcp14">MUST</span> be
shown clearly and with high prominence.<a href="#section-5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.2">
            <p id="section-5.1-2.2.1">The client <span class="bcp14">MUST NOT</span> cut off parts of long second-level domains, to avoid
spoofing. At least 63 characters <span class="bcp14">MUST</span> be displayed.<a href="#section-5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.3">
            <p id="section-5.1-2.3.1">Care <span class="bcp14">SHOULD</span> be taken with international characters that look like ASCII
characters, but have a different code.<a href="#section-5.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="login-test">
<section id="section-5.2">
        <h3 id="name-login-test">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-login-test" class="section-name selfRef">Login test</a>
        </h3>
<p id="section-5.2-1">After the user confirmed the configuration, you <span class="bcp14">SHOULD</span> test the configuration,
by attempting a login to each server configured. Only if the login succeeded,
and the server is working, should the configuration be saved and retrieving
and sending mail be started.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oauth2-windows">
<section id="section-5.3">
        <h3 id="name-oauth2-windows">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-oauth2-windows" class="section-name selfRef">OAuth2 windows</a>
        </h3>
<p id="section-5.3-1">If the configuration contains OAuth2 authentication, or any other kind of
authentication that uses a web browser with URL redirects,
you <span class="bcp14">MUST</span> show the full URL or the second-level domain of the current page
to the end user, at all times, including after page changes, URL changes,
or redirects. The authentication start URL may be the email hoster, but
it redirects to a corporate server for login, and then back to the hoster.
This allows for setups where the hoster is not allowed to see the
plaintext passwords.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">Showing the URL or hostname allows the end user to verify that he is
logging in at the expected page, e.g. the login server of their company,
instead of the email hoster's page. It is important that the user verifies
that he enters the passwords on the right domain.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="config-publishing-by-mail-providers">
<section id="section-6">
      <h2 id="name-config-publishing-by-mail-p">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-config-publishing-by-mail-p" class="section-name selfRef">Config publishing by mail providers</a>
      </h2>
<p id="section-6-1">Mail service providers who want to support this specification
and publish the mail configuration for their own mail service,
so that mail client apps can be automatically configured,
<span class="bcp14">SHOULD</span> follow this section as guideline and <span class="bcp14">MUST</span> respect the
definitions in this specification.<a href="#section-6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1">
          <p id="section-6-2.1.1">Configuration fields <span class="bcp14">MUST NOT</span> contain invalid or non-working
configuration data.<a href="#section-6-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-2.2">
          <p id="section-6-2.2.1">The provided configuration <span class="bcp14">MUST</span> be working,
and <span class="bcp14">SHOULD</span> use state-of-the-art security.<a href="#section-6-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-2.3">
          <p id="section-6-2.3.1">Configurations <span class="bcp14">MUST</span> be public and <span class="bcp14">MUST NOT</span> require
authentication (see below).<a href="#section-6-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="config-location-for-single-domain">
<section id="section-6.1">
        <h3 id="name-config-location-for-single-">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-config-location-for-single-" class="section-name selfRef">Config location for single domain</a>
        </h3>
<p id="section-6.1-1">The configuration file <span class="bcp14">SHOULD</span> be published at the URL for
step 1.1., i.e.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">
            <p id="section-6.1-2.1.1"><code>https://autoconfig.%EMAILDOMAIN%/.well-known/mail-v1.xml?emailaddress=%EMAILADDRESS%</code><a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-3">e.g. for fred@example.com<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-4.1">
            <p id="section-6.1-4.1.1">https://autoconfig.example.com/.well-known/mail-v1.xml?emailaddress=fred@example.com<a href="#section-6.1-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-5">For backwards compatibility with older mail clients,
step 1.2. should also be implemented.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="config-location-for-domain-hosters">
<section id="section-6.2">
        <h3 id="name-config-location-for-domain-">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-config-location-for-domain-" class="section-name selfRef">Config location for domain hosters</a>
        </h3>
<p id="section-6.2-1">For mail providers which host entire domains for their business
customers, the same URL as listed in the previous section is
preferred.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Alternatively, the configuration file <span class="bcp14">SHOULD</span> be published at
the location for step 3.1., i.e.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.1">
            <p id="section-6.2-3.1.1"><code>https://autoconfig.%MXFULLDOMAIN%/.well-known/mail-v1.xml?emailaddress=%EMAILADDRESS%</code><a href="#section-6.2-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.2-4">E.g. if the MX server for customer domain example.net is
"mx.premium.europe.example.com", then the config file should be at<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-5.1">
            <p id="section-6.2-5.1.1">https://autoconfig.premium.europe.example.com/.well-known/mail-v1.xml?emailaddress=fred@example.net<a href="#section-6.2-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.2-6">For backwards compatibility with older mail clients,
step 3.2. should also be implemented.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="return-config-for-non-existing-email-addresses">
<section id="section-6.3">
        <h3 id="name-return-config-for-non-exist">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-return-config-for-non-exist" class="section-name selfRef">Return config for non-existing email addresses</a>
        </h3>
<p id="section-6.3-1">Servers <span class="bcp14">SHOULD</span> return a valid config, even if the email address
sent as URL parameter does not exist. Otherwise, spammers
or attackers would be able to test the validity of email addresses.
This is true even if the config server needs the email address
to determine which of multiple configurations is correct.
In such a configuration, if the client sends a non-existing
email address, the config server <span class="bcp14">SHOULD</span> return one of the
valid configuations, so that valid and invalid email addresses
are indistiguishable.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="no-authentication-for-config">
<section id="section-6.4">
        <h3 id="name-no-authentication-for-confi">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-no-authentication-for-confi" class="section-name selfRef">No authentication for config</a>
        </h3>
<p id="section-6.4-1">Any of the above URLs for retrieving the config file <span class="bcp14">MUST NOT</span>
require authentication, but <span class="bcp14">MUST</span> be public.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">This is because the config contains the authentication method.
Without knowing the config, the client does not know which
authentication method is required and which username form
(e.g. username "fred" or "fred@example.com" or "fred\EXAMPLE")
to use. Given that the config is required for authentication,
the config itself cannot require authentication.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oauth2-requirements">
<section id="section-6.5">
        <h3 id="name-oauth2-requirements">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-oauth2-requirements" class="section-name selfRef">OAuth2 requirements</a>
        </h3>
<p id="section-6.5-1">If OAuth2 is used, the provider <span class="bcp14">MUST</span> adhere to the
"Open Profile for Public Clients" or
<a href="https://benbucksch.github.io/mauth-spec/draft-mauth.html">mAuth</a>
specification.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">The OAuth2 server <span class="bcp14">MUST</span> either accept the public client ID
as given in the config file, without secret, or <span class="bcp14">MUST</span> allow the
string <code>open</code> as client ID, or both. The server <span class="bcp14">MUST NOT</span>
employ any other methods to block clients that are acting on
behalf of users.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">The specifications also contain requirements for expiry times and
the login page, which are needed for mail client applications to work.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
<p id="section-6.5-4">The OAuth2 scope <span class="bcp14">MUST</span> include all services defined in this config file.
The same refresh and access token <span class="bcp14">MUST</span> be valid for all services defined
in the same config file, including for all URL-based protocols like CalDAV
and all TCP-based protocols like IMAP.<a href="#section-6.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="alternatives-considered">
<section id="section-7">
      <h2 id="name-alternatives-considered">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-alternatives-considered" class="section-name selfRef">Alternatives considered</a>
      </h2>
<div id="dnssec">
<section id="section-7.1">
        <h3 id="name-dnssec">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-dnssec" class="section-name selfRef">DNSSEC</a>
        </h3>
<p id="section-7.1-1">Due to their top-level domain, some domains do not have DNSSEC available to
them, even if they would like to deploy it.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Even where the top-level domain supports it, DNSSEC is currently deployed in
only 1% of domains, with adoption rates falling instead of rising, due to the
difficulties of administrating it correctly.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">Therefore, DNSSEC cannot be relied on in this specification, and DNS must be
considered insecure for the purposes of this specification.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dns-srv">
<section id="section-7.2">
        <h3 id="name-dns-srv">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-dns-srv" class="section-name selfRef">DNS SRV</a>
        </h3>
<p id="section-7.2-1">DNS SRV protocols (RFC 2782, RFC 6186) are not used here, for 2 reasons:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.2-2">
<li id="section-7.2-2.1">
            <p id="section-7.2-2.1.1">DNS SRV relies on insecure DNS and the config can therefore be trivially
spoofed by an attacker. See also DNSSEC above.<a href="#section-7.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-2.2">
            <p id="section-7.2-2.2.1">DNS SRV does not provide all the necessary configuration parameters. For
example, we need all of:<a href="#section-7.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<ul class="normal">
<li class="normal" id="section-7.2-3.1">
            <p id="section-7.2-3.1.1">the username form ("fred@example.com", or "fred", or "fred\EXAMPLE", or even
a username with no relation to the email address)<a href="#section-7.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-3.2">
            <p id="section-7.2-3.2.1">authentication method (password, CRAM-MD5, OAuth2, SSL client certificate)<a href="#section-7.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-3.3">
            <p id="section-7.2-3.3.1">authentication method parameters (e.g. OAuth parameters)<a href="#section-7.2-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.2-4">and other parameters. If any of these parameters are not configured right, the
configuration won't work. While these parameters could theoretically be added
to DNS SRV, that would mean a new specification and render the idea void that
this is a protocol that already exists, is standardized and deployed. It is
unlikely that all DNS SRV records would be updated with the new values.
Therefore, it does not solve the problem.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">This specification was created as an answer to these deficiencies and provides
an alternative to DNS SRV.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="capabilities">
<section id="section-7.3">
        <h3 id="name-capabilities">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-capabilities" class="section-name selfRef">CAPABILITIES</a>
        </h3>
<p id="section-7.3-1">Deployments in the wild from actual ISPs show that protocol-specific commands
to find available authentication methods, e.g. IMAP <code>CAPABILITIES</code> or POP3
<code>CAPA</code>, are not reliable. Many email servers advertize authentication methods
that do not work.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">Some IMAP servers are default configured to list all SASL authentication
methods that have corresponding libraries installed on the system, independent
on whether they are actually configured to work. The client receives a long
list of authentication methods, and many of them do not work. Additionally,
the server response may be only "authentication failed" and may not indicate
whether the method failed due to lack of configuration, or because the
password was wrong. Because some authentication servers lock the account after
3 failed login attempts, and it may also fail due to unrelated reasons (e.g.
username form, wrong password, etc.), the client cannot blindly issue
countless login attempts. Locking the account must be avoided. So, simply
attempting all methods and seeing which one works is not an option for the
email client.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">Additionally, some email servers advertize Kerberos / GSSAPI, but when trying
to use it, the method fails, and also runs into a long 2 minute timeout in
some cases. End users consider that to be a broken app.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">Additionally, such commands are protocol specific and have to be implemented
in multiple different ways.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5">Finally, some non-mail protocols may not support capabilties commands that
include authentication methods.<a href="#section-7.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="risk">
<section id="section-8.1">
        <h3 id="name-risk">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-risk" class="section-name selfRef">Risk</a>
        </h3>
<p id="section-8.1-1">If an attacker can provide a forged configuration, the provided mail hostname
and authentication server can be controlled by the attacker, and the attacker
can get access to the plain text password of the user. The attack can be
implemented as man-in-the-middle, so the end user might receive mail as
expected and never notice the attack.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">An attacker gaining the plain text password of a real user is a very
significant threat for the organization, not only because mail itself can
contain sensitive information and can be used to issue orders within the
organization that have wide-ranging impact, but given single-sign-on
solutions, the same username and password may give access to other resources
at the organization, including other computers or, in the case of admin users,
even adminstrative access to the core of the entire organization.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">Multi-factor authentication might not defend against such attacks, because the
user may believe to be logging into his email and therefore comply with any
multi-factor authentication steps required.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dns">
<section id="section-8.2">
        <h3 id="name-dns">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-dns" class="section-name selfRef">DNS</a>
        </h3>
<p id="section-8.2-1">Any protocol that relies on DNS without further validation, e.g. http, should
be considered insecure.
This also applies to the DNS MX lookup and the https calls that base on its
results, as described in section "MX".<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">One possible mitigation is to use multiple different DNS servers and verify
that the results match, e.g. to use the native DNS resolver of the operating
system, and additionally also query a hardcoded DoH (DNS over HTTPS) server.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Nonetheless, the result should be used with care. If such configs are used,
the end user <span class="bcp14">MUST</span> explicitly confirm the config, particularly the resulting
second-level domains. See section "User approval".<a href="#section-8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http">
<section id="section-8.3">
        <h3 id="name-http">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-http" class="section-name selfRef">HTTP</a>
        </h3>
<p id="section-8.3-1">HTTP requests may be intercepted, redirected, or altered at the network level.
See "Risk" above.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">Even if an http URL redirects to a https URL, and the domain of the https URL
cannot be validated against the email domain, that is still insecure.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">For that reason, clients <span class="bcp14">MUST</span> prefer HTTPS over HTTP during config retrieval,
within the same retrieval method.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4">If such configs from HTTP are used, the end user <span class="bcp14">MUST</span> explicitly confirm the
config, particularly the resulting second-level domains. See section
"User approval".<a href="#section-8.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="config-updates">
<section id="section-8.4">
        <h3 id="name-config-updates">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-config-updates" class="section-name selfRef">Config updates</a>
        </h3>
<p id="section-8.4-1">Part of the security properties of this protocol assume that the timeframe of
possible attack is limited to the moment when the user manually sets up a new
mail client. This moment is triggered by the end user, and a rare action -
e.g. maybe once per year or even less, for typical setups -, so an attacker
has limited chances to run an attack. While not a complete protection on its
own, this reduces the risk significantly.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">However, if the mail client does regular configuration updates using this
protocol, this security property is no longer given. For regular configuration
updates, the mail client <span class="bcp14">MUST</span> use only mechanisms that are secure and cannot
be tampered with by an active attacker. Furthermore, the user <span class="bcp14">SHOULD</span> still
approve config changes.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4-3">But even with all these protections implemented, the mail client vendor should
make a security assessment for the risks of making such regular updates. The
mail client vendor should consider that servers can be hacked, and most users
simply approve changes proposed by the app, so these give only a limited
protection.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-security">
<section id="section-8.5">
        <h3 id="name-server-security">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-server-security" class="section-name selfRef">Server security</a>
        </h3>
<p id="section-8.5-1">Given that mail clients will trust the configuration, the server delivering
the configuration file needs to be secure. A static web server offers better
security. The server software <span class="bcp14">SHOULD</span> be updated regularly and hosted on a
dedicated secure server with all unnecessary services and server features
turned off.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">For the ISPDB, additions and modifications to the configurations are
applicable to all respective users and must be made with care. The
authenticity of the configuration <span class="bcp14">MUST</span> be verified from authorative sources.
Server hostnames <span class="bcp14">MUST</span> be compared with the email domain names they are
serving, and if they differ, the ownership of the server hostnames <span class="bcp14">MUST</span> be
validated.<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<p id="section-8.5-3">The risk is mitigated to some degree by section "User approval".<a href="#section-8.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="registration">
<section id="section-9.1">
        <h3 id="name-registration">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-registration" class="section-name selfRef">Registration</a>
        </h3>
<p id="section-9.1-1">IANA will create the following registry in a new registry group called
"Mail Autoconfig":<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">Registry Name: "Autoconfig Protocol Type Names"<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">Registration Procedure: Specification Required, per RFC 8126, Section 4<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">Designated Expert: The author of this document.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contents">
<section id="section-9.2">
        <h3 id="name-contents">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-contents" class="section-name selfRef">Contents</a>
        </h3>
<p id="section-9.2-1">Table, with fields Element (alphanumeric), Type (alphanumeric), Base (URL or TCP or URL/TCP), Name, Specification, and Additional Elements<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">The registrations need to define
* Element: The XML element wrapping the server section.
* Type: The <code>type</code> property value of the server section.
* Base: Whether the protocol is URL-based or TCP-based,
* Name: The commonly used name of the protocol
* Specification: Which RFCs or document specifies the protocol, and
* Additional Elements: (Optional) Protocol-specific XML elements and
  their meaning.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initial-registration">
<section id="section-9.3">
        <h3 id="name-initial-registration">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-initial-registration" class="section-name selfRef">Initial registration</a>
        </h3>
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Element</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Base</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
              <th class="text-left" rowspan="1" colspan="1">Additional Elements</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">incomingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>jmap</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">JMAP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 8620, RFC 8621, RFC 8887, RFC 9610 et al</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">incomingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>imap</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TCP</td>
              <td class="text-left" rowspan="1" colspan="1">IMAP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9051 or RFC 3501, et al</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">incomingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>pop3</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TCP</td>
              <td class="text-left" rowspan="1" colspan="1">POP3</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 1939, RFC 5034</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">outgoingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>smtp</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TCP</td>
              <td class="text-left" rowspan="1" colspan="1">SMTP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 5321, RFC 2822</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">calendar</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>caldav</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">CalDAV</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 4791</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">addressbook</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>carddav</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">CardDav</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 6352</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">fileShare</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>webdav</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">WebDAV</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 4918</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">chatServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>xmpp</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">XMPP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 6120, RFC 6121, RFC 7395</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">chatServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>xmpptcp</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TCP</td>
              <td class="text-left" rowspan="1" colspan="1">XMPP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 6120, RFC 6121</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">chatServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>matrix</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">Matrix</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="https://spec.matrix.org">https://spec.matrix.org</a>
</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">setupServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>managesieve</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TCP</td>
              <td class="text-left" rowspan="1" colspan="1">ManageSieve</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 5804, RFC 5228</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">incomingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>ews</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">Exchange Web Services</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">incomingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>activeSync</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">ActiveSync</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">incomingServer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>graph</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">URL</td>
              <td class="text-left" rowspan="1" colspan="1">Microsoft Graph</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
<p id="section-9.3-2">The Additional Elements field is empty in all of the initial values.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-10">
      <h2 id="name-conventions-and-definitions">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-10-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-normative-references">
<section id="section-11">
      <h2 id="name-normative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
    <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ben Bucksch</span></div>
<div dir="auto" class="left"><span class="org">Beonex</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ben.bucksch@beonex.com" class="email">ben.bucksch@beonex.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
